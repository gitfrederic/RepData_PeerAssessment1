# Reproducible Research: Peer Assessment 1

```{r setoptions,echo=TRUE}
opts_chunk$set(echo = TRUE)
```


## Loading and preprocessing the data

```{r part1}
data <- read.csv(unz("activity.zip", "activity.csv"), header=TRUE, quote="\"", sep=",", na.strings="NA", colClasses=c(steps="integer", date="character", interval="integer"))
data$date <- as.POSIXct(data$date, format = "%Y-%m-%d" , tz = "US/Pacific")
```



## The mean total number of steps taken per day.

```{r part2_1}

# Make a histogram of the total number of steps taken each day
removed_steps_na_data <- subset(data, !is.na(steps))
sum_steps_per_day <- aggregate(removed_steps_na_data$steps, by=list(removed_steps_na_data$date), sum)
library(ggplot2)
ggplot(sum_steps_per_day, aes(Group.1, x)) + geom_histogram(stat="identity", binwidth=24*60*60) + xlab("Day") + ylab("# Steps") + ggtitle("# Steps Per Day")
```


## The mean and median of the total number of steps taken per day

```{r part2_2}

# Calculate and report the mean and median total number of steps taken per day
mean_steps_per_day <- mean(sum_steps_per_day$x)
median_steps_per_day <- median(sum_steps_per_day$x)
```

The **mean** total number of steps taken per day is **`r sprintf("%.4f", mean_steps_per_day)` steps**.

The **median** total number of steps taken per day is **`r median_steps_per_day` steps**.


## The average daily activity pattern

```{r part3_1}

# Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
mean_steps_per_5min <- aggregate(removed_steps_na_data$steps, by=list(removed_steps_na_data$interval), mean)
# ggplot(yt.views, aes(Date, Views)) + geom_line() + scale_x_date(format = "%b-%Y") + xlab("") + ylab("Daily Views")
ggplot(mean_steps_per_5min, aes(Group.1, x)) + geom_line(stat="identity", binwidth=5*60) + xlab("5 Minute Interval") + ylab("Avg. # of Steps Over All Days)") + ggtitle("Average Daily Activity Pattern")
```


```{r part3_2}

# Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

max_steps_on_average_in_5min_interval <- max(mean_steps_per_5min$x)
interval_with_max_steps_on_average <- subset(mean_steps_per_5min, x == max_steps_on_average_in_5min_interval)$Group.1
```

The interval with the maximum number of steps, on average (across all days) is **`r interval_with_max_steps_on_average`**.



## Imputing missing values

```{r part4_1}

# Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
total_number_of_missing_values <- nrow(subset(data, is.na(steps) | is.na(date) | is.na(interval)))
```

There are **`r total_number_of_missing_values`** rows with NAs in the dataset.

```{r part4_2}

# Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.

```

## Are there differences in activity patterns between weekdays and weekends?

